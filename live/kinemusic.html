<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Kinematic Music Visualization</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #f0f0f0;
				margin: 0px;
				overflow: hidden;
			}
		</style>
	</head>
	<body>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
		<script src="../lib/three.min.js"></script>
        <script src="../lib/Detector.js"></script>
        <script src="../lib/OrbitControls.js"></script>
        <script>
            if(!Detector.webgl) Detector.addGetWebGLMessage();

            var container;
            var camera, scene, renderer;
            var mesh, texture, geometry, material;

            var clock = new THREE.Clock();

            init();
            update();

            function init()
            {
                container = document.createElement('div');
                document.body.appendChild(container);

                camera = new THREE.PerspectiveCamera
                (
                    45,
                    window.innerWidth / window.innerHeight,
                    1,
                    2000
                );
                camera.position.y = 400;

                controls = new THREE.OrbitControls(camera);

                scene = new THREE.Scene();

                var light;

                // LIGHTS
                scene.add(new THREE.AmbientLight(0x404040));
                light = new THREE.DirectionalLight(0xffffff);
                light.position.set(0, 1, 0);
                scene.add(light);

                // MATERIALS
                material = new THREE.MeshLambertMaterial({color: 0x9900CC, shading: THREE.FlatShading});

                // GEOMETRY AND MESHES
                geometry = new THREE.SphereGeometry(100, 64, 64);
                geometry.applyMatrix(new THREE.Matrix4().makeRotationX(- Math.PI / 2));
                geometry.dynamic = true;

                geometry.computeFaceNormals();
                geometry.computeVertexNormals();

                mesh = new THREE.Mesh(geometry, material);
                scene.add(mesh);

                renderer = new THREE.WebGLRenderer({antialias: true});
                renderer.setSize(window.innerWidth, window.innerHeight);
                container.appendChild(renderer.domElement);
                window.addEventListener('resize', onWindowResize, false);
            }

            function update()
            {
                requestAnimationFrame(update);
                controls.update();
                render();
            }

            function render()
            {
                var delta = clock.getDelta(),
                        time = clock.getElapsedTime() * 10;

                /*
                for(var i = 0, l = geometry.vertices.length; i < l; i++)
                {
                    geometry.vertices[i].x += Math.sin(i / 5 + (time + i) / 7);
                }*/

                mesh.geometry.verticesNeedUpdate = true;

                camera.lookAt(scene.position);
                renderer.render(scene, camera);
            }

            function onWindowResize()
            {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }
		</script>
	</body>
</html>